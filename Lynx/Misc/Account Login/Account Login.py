# Title: Account Login
# Date: 4/15/2021
# Made by: pwd0kernel - pwdsec
# Profile: https://github.com/pwd0kernel
# Organization: https://github.com/pwdsec
# Description: just a tool because i was bored but
# atleast change bio works on this since its broken on the website.

# TODO: Get_lynx_latest_version
# TODO: Upload_script

import requests
import warnings
import wget
import json
from os import  system
from bs4 import BeautifulSoup

warnings.filterwarnings("ignore")

commands = [
"00) -\033[33m Malicious \033[0m- Will let you run -\033[33m malicious/\033[31mbugs/\033[34mvulns\033[0m found on Lynx",
"1) - AccountInfo - Will show the information of your account.",
"2) - ChangeBio - Will change your account bio on the website.",
"3) - UploadScript - Will upload your script to \"Cloudscript\"",
"4) - GetLynxAddys - Will get the addresses of Lynx that it uses in the exploit.",
"5) - GetLynxLatestVersion - Will show you the lastest version number.",
"6) - DownloadLynx - Will download Lynx.",
"7) - Credits - Who made this script.",
"8) - Clear - Will clear the console.",
"0) - Exit - Will exit the program.",
]

pwd0console = """
                  _  ___                            _      
 _ ____      ____| |/ _ \  ___ ___  _ __  ___  ___ | | ___ 
| '_ \ \ /\ / / _` | | | |/ __/ _ \| '_ \/ __|/ _ \| |/ _ \\
| |_) \ V  V / (_| | |_| | (_| (_) | | | \__ \ (_) | |  __/
| .__/ \_/\_/ \__,_|\___/ \___\___/|_| |_|___/\___/|_|\___|
|_|                                                        

"""

data = [] # Account data

def Get_Account_name():
    # fully done
    try:
        global lynx_cookies
        lynx_session = requests.Session()
        account = lynx_session.get("https://lynx.rip/dashboard/home/", cookies=dict(PHPSESSID=phpid), verify=False)
        lynx_cookies = lynx_session.cookies.get_dict()
        soup = BeautifulSoup(account.text, "html.parser")
        for username in soup.find_all("div", {"class": "font-weight-bold font-size-h5 text-light"}):
            if account.status_code == 200:
                if len(username.text) != 0 and len(username.text) <= 20:
                    data.append(username.text)
                else:
                    print("There was an error login into your account.")
                    exit()
            else:
                print("There was an error requesting the website. code: ", str(account.status_code))
    except Exception:
        print("There was an error while getting the account name.")

def Change_bio(bio_text): 
    # fully done
    # Original function on the website is broken
    # hopefully this one works | EDIT: it does work
    try:
        bio = requests.post("https://lynx.rip/dashboard/home/profile/", data={'bio': bio_text}, cookies=dict(PHPSESSID=phpid, did=lynx_cookies["did"],
        username=lynx_cookies["username"], avatar=lynx_cookies["avatar"]), verify=False)
        if bio.status_code == 200:
            check = requests.get("https://lynx.rip/dashboard/home/profile/", cookies=dict(PHPSESSID=phpid, did=lynx_cookies["did"],
            username=lynx_cookies["username"], avatar=lynx_cookies["avatar"]), verify=False)
            if check.status_code == 200:
                soup = BeautifulSoup(check.text, "html.parser")
                if len(soup.findAll("span")[14].text) == len(bio_text):
                    print("It was changed successfully.")
                else:
                    print("There was an error while changing bio.")
            else:
                print("There was an error while sending the request. code:", str(check.status_code))
        else:
            print("There was an error while sending the request. code:", str(bio.status_code))
    except Exception:
        print("There was an error while changing the bio.")

def Get_Account_bio():
    # fully done
    try:
        bio = requests.get("https://lynx.rip/dashboard/home/profile/", cookies=dict(PHPSESSID=phpid, did=lynx_cookies["did"],
        username=lynx_cookies["username"], avatar=lynx_cookies["avatar"]), verify=False)
        if bio.status_code == 200:
            soup = BeautifulSoup(bio.text, "html.parser")
            if len(soup.findAll("span")[14].text) != 0:
                data.append(soup.findAll("span")[14].text)
            else:
                print("There was an error while getting your bio.")
        else:
            print("There was an error while sending the request. code:", str(bio.status_code))
    except Exception:
        print("There was an error while getting the account bio.")


def ClearConsole():
    # fully done
    system("cls")
    print(pwd0console)
    print("----- [ Account ] -----\n")
    print("Logged in as:", data[0])
    print("Bio:", data[1])
    print("PHPSESSID:", phpid)
    print("\n----- [ Commands ] -----\n")
    for i in commands:
        print(i)

def Credits():
    # fully done
    print("Credits:")
    print("   Made by pwd0kernel - pwdsec")
    print("   Profile: https://github.com/pwd0kernel")
    print("   Organization: https://github.com/pwdsec")

def Account_info():
    # fully done
    print("Account Information:")
    print("   Username:", data[0])
    print("   Bio:", data[1])
    print("   PHPSESSID:", phpid)
    print("   Avatar (Encrypted):", lynx_cookies["avatar"])
    print("   Did (Encrypted):", lynx_cookies["did"])
    print("   Username (Encrypted):", lynx_cookies["username"])

def Upload_script():
    # not done
    print("Put your script in \"put_script_here.txt\" then type upload in console")
    script = open("put_script_here.txt", "wr")
    script.write("-- put your full script here")
    script.close()
    cloudscript_cmd = input("[Cloudscript]: ")
    if cloudscript_cmd.lower() == "upload":
        system("clear")
        print("uploading...")
        # if i code this, i have to do testing and tetunus will get mad
        # since its gonna upload a couple scripts on the website
        pass
    elif cloudscript_cmd.lower() == "cancel" or cloudscript_cmd.lower() == "exit":
        pass

def Get_lynx_addys():
    # fully done
    try:
        addys = requests.post("http://lynx.rip/backend/updater/v2/testing/", data={"version" : "1.0", "checking" : "get_addresses"}, verify=False)
        if addys.status_code == 200:
            addys_file = open("addys.txt", "w")
            addys_file.write(addys.text)
            addys_file.close()
            print("The addresses should be in the file \"addys.txt\"")
        else:
            print("There was an error while sending the request. code:", str(bio.status_code))
    except Exception:
        print("There was an error while getting the addys.")

def Get_lynx_latest_version():
    # not done
    pass


def Download_lynx():
    # fully done
    try:
        wget.download("https://lynx.rip/downloads/Lynx.zip", 'Lynx.zip')
    except Exception:
        print("There was an error while downloading Lynx.zip")

try:
    system("cls")
    phpid = input("[PHPSESSID]: ") # jda33thhn0s4s9skac2n6f8pb9
    if len(phpid) != 0 and len(phpid) <= 26 and len(phpid) >= 26:
        print("Logging in...")
        Get_Account_name()
        print("Getting Bio...")
        Get_Account_bio()
        system("cls")
        print(pwd0console)
        print("----- [ Account ] -----\n")
        print("Logged in as:", data[0])
        print("Bio:", data[1])
        print("PHPSESSID:", phpid)
        print("\n----- [ Commands ] -----\n")

        # print the command list.
        for i in commands:
            print(i)

        try:
            while True:
                cmd = input("\n[Command]: ")
                if cmd.lower() == "malicious" or cmd.lower() == "00":
                    pass
                elif cmd.lower() == "accountinfo" or cmd.lower() == "1":
                    Account_info()
                elif cmd.lower() == "changebio" or cmd.lower() == "2":
                    bio = input("[Bio Description]: ")
                    Change_bio(bio)
                elif cmd.lower() == "uploadscript" or cmd.lower() == "3":
                    Upload_script()
                    pass
                elif cmd.lower() == "getlynxaddys" or cmd.lower() == "4":
                    Get_lynx_addys()
                elif cmd.lower() == "getlynxlatestversion" or cmd.lower() == "5":
                    Get_lynx_latest_version()
                elif cmd.lower() == "downloadlynx" or cmd.lower() == "6":
                    Download_lynx()
                elif cmd.lower() == "credits" or cmd.lower() == "7":
                    Credits()
                elif cmd.lower() == "clear" or cmd.lower() == "8":
                    ClearConsole()
                elif cmd.lower() == "exit" or cmd.lower() == "cancel" or cmd.lower() == "0":
                    system("cls")
                    print("Thank you for using this!")
                    exit()
                else:
                    print("Command not found")
        except KeyboardInterrupt:
            system("cls")
            print("Thank you for using this!")
            exit()
    else:
        print("Please put a real PHPSESSID.")
except Exception:
    print("There was an error. try putting a valid PHPSESSID")